<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <ui:composition template="/template.xhtml">


        <ui:define name="body">
            <h:panelGroup id="messagePanel" layout="block">
                <h:messages errorStyle="color: red" infoStyle="color: green" layout="table"/>
            </h:panelGroup>
            <h1 align="left">Mise à Jour des Utilisateurs</h1>

            <center>
                <h:form id="MAJICreateForm">
                    <h:panelGroup id="display" >

                        <p:panelGrid columns="3" style="width: 100%"  >
                            <br />


                            <p:panelGrid id="pd" columns="3"  >
                                <p:outputLabel value="Identifiant : " for="util" />
                                <h:inputText readonly="true" id="util" value="#{mAJUtilisateurMBean.current.utilLogin}" required="true" requiredMessage="L'identifiant est obligatoire">

                                </h:inputText>

                                <p:commandButton value="Sélectionner l'Utilisateur"  onclick="PF('dlgIFU').show();" type="button">       
                                </p:commandButton>
                                <br />
                                <h:commandButton id="rech" value="Rechercher" action="#{mAJUtilisateurMBean.UpdateTableUtil()}" ></h:commandButton>
                                <br />
                                <br />

                                <c:if  test="#{mAJUtilisateurMBean.itemsUtil.utilActif == 'N'}" >



                                    <br />
                                    <h:outputLabel value="#{bundle.CreateTUtilisateurLabel_utilNumci}" for="utilNumci" />
                                    <h:inputText id="utilNumci" value="#{mAJUtilisateurMBean.current.utilNumci}" title="#{bundle.CreateTUtilisateurTitle_utilNumci}" required="true"/>
                                    <br />
                                    <h:outputLabel value="#{bundle.CreateTUtilisateurLabel_utilDateexpci}" for="utilDateexpci" />

                                    <p:calendar value="#{mAJUtilisateurMBean.current.utilDateexpci}" id="utilDateexpci" required="false"/>

                                    <br />
                                    <h:outputLabel value="#{bundle.CreateTUtilisateurLabel_utilLieudelivrci}" for="utilLieudelivrci" />
                                    <h:inputText id="utilLieudelivrci" value="#{mAJUtilisateurMBean.current.utilLieudelivrci}" title="#{bundle.CreateTUtilisateurTitle_utilLieudelivrci}" required="true" />

                                </c:if>
                            </p:panelGrid>

                            <br />


                            <br />


                            <br />

                        </p:panelGrid>

                        <center>

                            <h1 align="left"><h:outputText value="Informations de l'Utilisateur"/></h1>
                            <p:dataTable   id="ItemsUtil" value="#{mAJUtilisateurMBean.itemsUtil}" var="item"  style="text-align: center"> 


                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="Identifiant"/>
                                    </f:facet>
                                    <h:outputText value="#{item.utilLogin}"/>
                                </p:column>

                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="Nom"/>
                                    </f:facet>
                                    <h:outputText value="#{item.utilNom}"/>
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="Prénoms"/>
                                    </f:facet>
                                    <h:outputText value="#{item.utilPrenoms}"/>
                                </p:column>

                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="IFU"/>
                                    </f:facet>
                                    <h:outputText value="#{item.utilContImmatr}"/>
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="Télephone"/>
                                    </f:facet>
                                    <h:outputText value="#{item.utilTel}"/>
                                </p:column>


                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="Groupe"/>
                                    </f:facet>
                                    <h:outputText value="#{mAJUtilisateurMBean.itemsUtil.groupe.groupName}"/>
                                </p:column> 
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="Statut"/>
                                    </f:facet>

                                    <h:outputText value="#{mAJUtilisateurMBean.afficheStatut}"/>


                                </p:column>


                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="ACTION"/>
                                    </f:facet>
                                    <p:commandButton  value="#{mAJUtilisateurMBean.statut}" action="#{mAJUtilisateurMBean.MAJStatut()}" update=":MAJICreateForm:rech @form" ajax="true" />
                                </p:column>

                            </p:dataTable>


                        </center>
                        <br />

                    </h:panelGroup>
                </h:form>
            </center>

            <p:dialog id="dlgIFU" header="Utilisateurs"  dynamic="true" widgetVar="dlgIFU" modal="true" showEffect="explose"  width="800" height="400">
                <h:form>    
                    <p:dataTable  value="#{mAJUtilisateurMBean.utilisateur}" var="utilisateur"  paginator="true" lazy="true" sortMode="multiple" rows="20" emptyMessage="Aucun enregistrement trouvé pour l'instant !">

                        <p:column filterBy="#{utilisateur.utilLogin}" filterMatchMode="startsWith">
                            <f:facet name="header">
                                <h:outputText value="Identifiant"/>
                            </f:facet>                        
                            <p:commandLink value="#{utilisateur.utilLogin}"  action="#{mAJUtilisateurMBean.UtilisateurSelectionne(utilisateur)}" update=":MAJICreateForm:util" oncomplete="PF('dlgIFU').hide();"  process="@this" title="Selectionnez" style="color: blue;"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Email"/>
                            </f:facet>
                            <h:outputText value="#{utilisateur.utilEmail}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Téléphone"/>
                            </f:facet>
                            <h:outputText value="#{utilisateur.utilTel}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Groupe"/>
                            </f:facet>
                            <h:outputText value="#{utilisateur.groupe.groupName}"/>
                        </p:column>
                    </p:dataTable>
                </h:form>
            </p:dialog> 

        </ui:define>

    </ui:composition>
</html>

