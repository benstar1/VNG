<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui">
    <ui:composition template="/template.xhtml">


        <ui:define name="body">
                <h3 align="left" style="margin-top: 0px; margin-bottom: 0px;">Mise à Jour Collective</h3>
                <p:separator />
                 <p:messages id="msg" showSummary="true" />
                <f:view>
                    
                    <h:form enctype="multipart/form-data">
                       
                        <center>
                            <p:panelGrid columns="3"  style="width: 100%">
                                <h:outputLabel value="Fichier : " for="fichier" />

                                <h:inputFile id="fichier" value="#{mAJMBean.file}" size="40"/>   

                                <br /><br />    
                                <h:outputLabel value="Centre d'Impôt : " for="centreImpot" />

                                <h:selectOneMenu id="centreImpot" value="#{mAJMBean.cimpot}" >
                                    <f:selectItem itemLabel="----- Centre d'Impôt -----"></f:selectItem>
                                    <f:selectItems value="#{tRepUniqueController.cimpotItem}"/>
                                </h:selectOneMenu>

                                <br/>
                                <br/>

                                <h:outputLabel value="Action : " for="activation"  />
                                <h:selectOneRadio id="activation" value="#{mAJMBean.active}" >
                                    <f:selectItem itemValue="A" itemLabel="Activer" > </f:selectItem>
                                    <f:selectItem itemValue="D" itemLabel="Désactiver"> </f:selectItem>                        
                                </h:selectOneRadio>

                                <br/>
                                <br/>


                            </p:panelGrid>
                            <br />

                            <h:commandButton class="btn-primary" action="#{mAJMBean.upload}" value="     Mettre à Jour     " />
                            <br />
                            <br />

                        </center>



                        <c:if test="#{mAJMBean.charge.size() ge 1}" >

                            <center> 
                                <h3 align="center"><h:outputText value="Liste des Contribuables Mis à Jour"/> (#{mAJMBean.nbre_maj})</h3>
                                <p:dataTable value="#{mAJMBean.charge}"  var="item">

                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Numéro IFU"/>
                                        </f:facet>
                                        <h:outputText value="#{item.contImmatr}"/>
                                    </p:column>
                                    
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Numéro Dossier"/>
                                        </f:facet>
                                        <h:outputText value="#{item.contNum}"/>
                                    </p:column>
                                                                 
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Nom du Contribuable"/>
                                        </f:facet>
                                        <h:outputText value="#{item.contNom}"/>
                                    </p:column>
                                    
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Prénoms du contribuable"/>
                                        </f:facet>
                                        <h:outputText value="#{item.contPren}"/>
                                    </p:column>
                                    
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Raison sociale"/>
                                        </f:facet>
                                        <h:outputText value="#{item.contRais}"/>
                                    </p:column>
                                    
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Statut"/>
                                        </f:facet>
                                        <h:outputText value="#{item.contStatut}"/>
                                    </p:column>

                                </p:dataTable>

                            </center>
                           
                            <c:if test="#{mAJMBean.nbre_rejets != 0}" >
                            <center> 
                                <div>
                                    <div style="float: left; width: 65%"><h3 align="center"><h:outputText value="Liste de rejets"/>(#{mAJMBean.nbre_rejets})</h3></div>
                                    <div style="float: right; width: 20%; padding-top: 24px;"><h:commandLink class="exportPDF" actionListener="#{mAJMBean.export2PDF()}" value="Exporter vers PDF"></h:commandLink><img src="../../resources/images/pdf.jpg" style="height: 24px" alt=""/></div>
                                    
                                </div>
                                                                    
                                <p:dataTable value="#{mAJMBean.listeEchecs}"  var="item">

                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Numéro IFU"/>
                                        </f:facet>
                                        <h:outputText value="#{item.fauxIfu}"/>
                                    </p:column>
                                    
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Nom du contribuable"/>
                                        </f:facet>
                                        <h:outputText value="#{item.fauxNom}"/>
                                    </p:column>
                                                                 
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Prénoms du contribuable"/>
                                        </f:facet>
                                        <h:outputText value="#{item.fauxPrenoms}"/>
                                    </p:column>
                                    
                                </p:dataTable>

                            </center>
                                </c:if>

                        </c:if>
                        
                        
                           
                    </h:form>



                </f:view>

       
        </ui:define>
    </ui:composition>
</html>

